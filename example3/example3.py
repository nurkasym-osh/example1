import numpy as np
import matplotlib.pyplot as plt

def plotrates():
    N = np.array([20, 40, 80, 160])
    h = 2.0/N
    einf1 = np.array([4.82e-3, 1.25e-3, 3.16e-4, 7.93e-5])
    el11 = np.array([2.15e-3, 5.48e-4, 1.38e-4, 3.46e-5])
    el21 = np.array([2.73e-3, 6.92e-4, 1.74e-4, 4.36e-5]) 
    einf2 = np.array([7.14e-3, 1.86e-3, 4.73e-4, 1.19e-4])
    el12 = np.array([3.28e-3, 8.45e-4, 2.14e-4, 5.38e-5])
    el22 = np.array([4.12e-3, 1.05e-3, 2.66e-4, 6.69e-5]) 
    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))
    ax1.loglog(h, einf1, 'bo-', label='$\|\|e\|\|_{\infty}$')
    ax1.loglog(h, el11, 'rs-', label='$\|\|e\|\|_1$')
    ax1.loglog(h, el21, 'gd-', label='$\|\|e\|\|_2$')
    ax1.loglog(h, h**2, 'k--', label='$O(h^2)$')
    ax1.set_xlabel('Grid step (h)')
    ax1.set_ylabel('Error')
    ax1.set_title('а) Constant coefficients')
    ax1.grid(True)
    ax1.legend()    
    ax2.loglog(h, einf2, 'bo-', label='$\|\|e\|\|_{\infty}$')
    ax2.loglog(h, el12, 'rs-', label='$\|\|e\|\|_1$')
    ax2.loglog(h, el22, 'gd-', label='$\|\|e\|\|_2$')
    ax2.loglog(h, h**2, 'k--', label='$O(h^2)$')
    ax2.set_xlabel('Grid step (h)')
    ax2.set_ylabel('Error')
    ax2.set_title('б) Variable coefficients')
    ax2.grid(True)
    ax2.legend()    
    plt.tight_layout()
    plt.show()
plotrates()
